// ==UserScript==
// @name         Video Helper
// @namespace    http://tampermonkey.net/
// @version      0.1.10
// @description  优酷、爱奇艺、芒果TV、腾讯视频、哔哩哔哩VIP助手
// @include      *.youku.com/v*
// @include      *m.youku.com/*
// @include      *.iqiyi.com/v_*
// @include      *.iqiyi.com/w_*
// @include      *.iqiyi.com/a_*
// @include      *v.qq.com/x/*
// @include      *v.qq.com/p*
// @include      *v.qq.com/cover*
// @include      *v.qq.com/tv/*
// @include      *.mgtv.com/b/*
// @include      *.bilibili.com/bangumi/play/*
// @grant        none
// ==/UserScript==
!function(){"use strict";var e,a,r="_heart_video_last_url",t={mg:{flag:/mgtv/,wrap:"#mgtv-player-wrap"},qq:{flag:/v.qq/,wrap:"#player-container"},iqiyi:{flag:/iqiyi/,wrap:"#flashbox"},youku:{flag:/youku/,wrap:"#player"},bilibili:{flag:/bilibili/,wrap:"#player_module"}},l=function(e){for(var a in void 0===e&&(e=window.location.host),t)if(t[a].flag.test(e))return a;return null}();function i(e){var a=document.createElement("style");a.innerHTML=e,document.head.appendChild(a)}e="//at.alicdn.com/t/font_2320142_alfk2527dul.css",(a=document.createElement("link")).rel="stylesheet",a.href=e,document.head.appendChild(a);i(".hparse{--primary-color:#2196f3;position:fixed;left:0;top:50%;transform:translateY(-50%);color:#fff;font-size:14px;z-index:99999999999}.hparse-item{position:relative;padding:8px;text-align:center;background-color:var(--primary-color);cursor:pointer}.hparse-item:nth-child(n+2){margin-top:8px}.hparse-item:hover .hparse-path-list,.hparse-item:hover .hparse-speed-list{display:block}.hparse-path-list,.hparse-speed-list{display:none;position:absolute;top:50%;right:0;width:100px;border-left:8px solid transparent;transform:translate(100%,-50%)}.hparse-path-wrap,.hparse-speed-wrap{border:1px solid var(--primary-color);background-color:var(--primary-color)}.hparse-path-item,.hparse-speed-item{padding:8px 0;text-align:center;transition:all linear .2s;overflow:hidden}.hparse-path-item:hover:not(.blur),.hparse-speed-item:hover:not(.blur){background-color:#fff;color:var(--primary-color)}.hparse-speed-control{display:inline-block;width:28px;height:28px;line-height:28px}.hparse-speed-control:hover{background-color:rgba(255,255,255,.3)}"),"qq"===l&&i("\n  #app .playlist-intro,\n  #app .playlist-intro__detail,\n  #app .playlist-top\n  {margin:0;}\n  \n  ");var n=[{name:"JSON",url:"https://jx.jsonplayer.com/player/?url={{url}}"},{name:"XM",url:"https://dm.xmflv.com:4433/?url={{url}}"},{name:"Mao",url:"https://www.mtosz.com/erzi.php?url={{url}}"},{name:"NX",url:"https://www.nxflv.com/?url={{url}}"},{name:"4K",url:"https://jx.4kdv.com/?url={{url}}"},{name:"okjx",url:"https://okjx.cc/?url={{url}}"},{name:"B站-1",url:"https://vip.parwix.com:4433/player/analysis.php?v={{url}}"},{name:"JY",url:"https://jx.playerjy.com/?url={{url}}"},{name:"jiexila",url:"https://www.jiexila.com/?url={{url}}"}],o=localStorage.getItem(r);o&&n.unshift({name:"上次使用",url:o});var p=[{name:"+30s",type:"currentTime",value:30},{name:"+15s",type:"currentTime",value:15},{name:"+5s",type:"currentTime",value:5},{name:"2.0",type:"playbackRate",value:2},{name:"1.75",type:"playbackRate",value:1.75},{name:"1.5",type:"playbackRate",value:1.5},{name:"1.25",type:"playbackRate",value:1.25},{name:"1",type:"playbackRate",value:1}];var s=document.createElement("iframe");s.allowFullscreen="true",s.frameBorder="0",s.allowfullscreen="true",s.width="100%",s.height="100%",function(){var e=document.createElement("div");e.className="hparse",e.innerHTML='<div class="hparse-item"><i class="h5-icon icon-you-tube"></i><div class="hparse-path-list"><div class="hparse-path-wrap"></div></div></div><div class="hparse-item"><i class="h5-icon icon-sudu"></i><div class="hparse-speed-list"><div class="hparse-speed-wrap"></div></div></div>';var a=function(){for(var e=[],a=0,r=n.length;a<r;a++){var t=n[a];t.hide&&0!==t.hide.length&&-1!==t.hide.indexOf(l)||e.push(t)}return e}(),i=e.querySelector(".hparse-path-wrap");a.forEach((function(e,a){var r=document.createElement("div");r.className="hparse-path-item",r.textContent=e.name,r.dataset.index=a,i.appendChild(r)})),i.addEventListener("click",(function(e){var i=e.srcElement||e.target;!function(e){if(!l)return;var a=(i=e.url,n="url",o=window.location.origin+window.location.pathname,i.replaceAll("{{"+n+"}}",o));var i,n,o;if("link"===e.type)return void window.open(a,"_blank");(function(){if("iqiyi"===l){var e=document.querySelector(".qy-player-vippay-popup");e&&document.body.removeChild(e.parentElement)}})(),s.src=a,localStorage.setItem(r,e.url);var p=document.querySelector(t[l].wrap);p&&(p.innerHTML="",p.appendChild(s))}(a[i.dataset.index])}));var o=p.concat(),c=e.querySelector(".hparse-speed-wrap");o.forEach((function(e,a){var r=document.createElement("div");r.className="hparse-speed-item",r.textContent=e.name,r.dataset.index=a,c.appendChild(r)})),c.addEventListener("click",(function(e){var a=e.srcElement||e.target,r=o[a.dataset.index],t=document.querySelector(".h5-ext-layer video")||document.querySelector("video");t&&("currentTime"===r.type?t.currentTime+=r.value:t.playbackRate=r.value)})),document.body.appendChild(e)}(),"qq"===l&&$(".playlist-rect__col [data-vid]").off("click").on("click",(function(){location.href="https://v.qq.com/x/cover/"+this.dataset.cid+"/"+this.dataset.vid+".html"}))}();
